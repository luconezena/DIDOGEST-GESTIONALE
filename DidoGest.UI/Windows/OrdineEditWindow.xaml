<Window x:Class="DidoGest.UI.Windows.OrdineEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Ordine" Height="700" Width="800" WindowStartupLocation="CenterScreen"
        Style="{StaticResource MaterialDesignWindow}">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Dati Ordine" FontSize="24" FontWeight="Bold" Margin="0,0,0,20"/>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <Grid Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="180"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox Grid.Column="0" x:Name="CmbTipo" Margin="0,0,10,0"
                              materialDesign:HintAssist.Hint="Tipo" 
                              Style="{StaticResource MaterialDesignOutlinedComboBox}"
                              SelectionChanged="CmbTipo_SelectionChanged"/>
                    <TextBox Grid.Column="1" x:Name="TxtNumero" Margin="0,0,10,0"
                             materialDesign:HintAssist.Hint="Numero" 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                    <DatePicker Grid.Column="2" x:Name="DpData"/>
                </Grid>

                <ComboBox x:Name="CmbCliente" Margin="0,0,0,15"
                          materialDesign:HintAssist.Hint="Cliente" 
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"/>

                <ComboBox x:Name="CmbFornitore" Margin="0,0,0,15"
                          materialDesign:HintAssist.Hint="Fornitore" 
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"/>

                <TextBox x:Name="TxtStato" materialDesign:HintAssist.Hint="Stato (es. APERTO)" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,15"/>

                <TextBox x:Name="TxtNote" materialDesign:HintAssist.Hint="Note" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}" AcceptsReturn="True" Height="140"/>

                <Grid Margin="0,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <WrapPanel Grid.Row="0" Margin="0,0,0,8">
                        <Button Content="Aggiungi riga" Click="BtnAggiungiRiga_Click" Margin="0,0,10,0" Style="{StaticResource MaterialDesignRaisedButton}"/>
                        <Button Content="Rimuovi riga" Click="BtnRimuoviRiga_Click" Style="{StaticResource MaterialDesignOutlinedButton}"/>
                    </WrapPanel>

                    <DataGrid Grid.Row="1" x:Name="RigheDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" MinHeight="220"
                              materialDesign:DataGridAssist.ColumnHeaderPadding="8">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="#" Binding="{Binding NumeroRiga}" Width="50" IsReadOnly="True"/>

                            <DataGridTemplateColumn Header="Articolo" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ArticoloCodice}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                                <DataGridTemplateColumn.CellEditingTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ArticoliForCombo}"
                                                  SelectedValuePath="Id"
                                                  DisplayMemberPath="Codice"
                                                  SelectedValue="{Binding ArticoloId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellEditingTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="Descrizione" Binding="{Binding Descrizione, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                            <DataGridTextColumn Header="Q.tÃ " Binding="{Binding QuantitaOrdinata, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="90"/>
                            <DataGridTextColumn Header="Prezzo" Binding="{Binding PrezzoUnitario, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="90"/>
                            <DataGridTextColumn Header="IVA%" Binding="{Binding AliquotaIVA, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="70"/>
                            <DataGridTextColumn Header="Totale" Binding="{Binding Totale}" Width="100" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <TextBlock Text="Imponibile:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock x:Name="LblImponibile" Text="0,00" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <TextBlock Text="IVA:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock x:Name="LblIva" Text="0,00" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <TextBlock Text="Totale:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock x:Name="LblTotale" Text="0,00" FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="Salva" Click="BtnSalva_Click" 
                    Style="{StaticResource MaterialDesignRaisedButton}" Width="100" Margin="0,0,10,0"/>
            <Button Content="Annulla" Click="BtnAnnulla_Click" 
                    Style="{StaticResource MaterialDesignOutlinedButton}" Width="100"/>
        </StackPanel>
    </Grid>
</Window>
